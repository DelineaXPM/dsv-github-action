---
name: release-composite
on:
  push:
    tags:
      - 'v*'
  workflow_dispatch:
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}-${{ github.workflow }}
  cancel-in-progress: true

permissions:
  pull-requests: write
  contents: read # Because it needs to read the configuration file
  checks: write

jobs:
  lint:
    uses: ./.github/workflows/lint.yml
    secrets: inherit
    inputs:
      github-ref: ${{ github.ref }}
  test:
    uses: ./.github/workflows/test.yml
    secrets: inherit
  integration:
    needs: test
    uses: ./.github/workflows/integration.yml
    secrets: inherit
  release:
    needs: integration
    uses: ./.github/workflows/release.yml
    secrets: inherit
